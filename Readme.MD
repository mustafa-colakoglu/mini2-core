# @mini2/core

**Mini Express Framework** - Express.js tabanlÄ± hafif ve modÃ¼ler web framework'Ã¼. TypeScript desteÄŸi, otomatik Swagger dokÃ¼mantasyonu, dependency injection ve decorator tabanlÄ± routing sistemi ile modern API geliÅŸtirme deneyimi saÄŸlar.

## âœ¨ Ã–zellikler

- ğŸš€ **Decorator TabanlÄ± Routing**: `@Get`, `@Post` gibi decorator'lar ile kolay route tanÄ±mlama
- ğŸ“ **Otomatik Swagger DokÃ¼mantasyonu**: API dokÃ¼mantasyonu otomatik oluÅŸturulur
- ğŸ”§ **Dependency Injection**: InversifyJS tabanlÄ± gÃ¼Ã§lÃ¼ DI container
- ğŸ›¡ï¸ **GÃ¼venlik Middleware'leri**: Authentication, authorization ve validation
- ğŸ“¦ **Tam TypeScript DesteÄŸi**: Type-safe API geliÅŸtirme
- ğŸ¯ **Response Builder**: TutarlÄ± API yanÄ±tlarÄ±
- âš¡ **HÄ±zlÄ± Kurulum**: Minimal konfigÃ¼rasyon

## ğŸ“¦ Kurulum

```bash
npm install @mini2/core
```

### Peer Dependencies (Opsiyonel)

```bash
# EÄŸer MongoDB kullanÄ±yorsanÄ±z
npm install mongoose
```

## ğŸš€ HÄ±zlÄ± BaÅŸlangÄ±Ã§

### 1. Temel KonfigÃ¼rasyon

```typescript
import { App, IConfig } from '@mini2/core';

const config: IConfig = {
	port: 3000,
	host: 'localhost',
	applicationName: 'My API',
};

// Controller'larÄ± tanÄ±mlayÄ±n
const controllers = [
	// Controller sÄ±nÄ±flarÄ±nÄ±z
];

const app = new App(controllers);
await app.init(config);
await app.afterInit();
```

### 2. Controller OluÅŸturma

```typescript
import {
	Controller,
	Get,
	Post,
	ResponseBuilder,
	validationMiddleware,
} from '@mini2/core';

@Controller('/api/users')
export class UserController {
	@Get('/')
	async getUsers() {
		const users = await this.userService.findAll();
		return new ResponseBuilder().ok(users);
	}

	@Post('/')
	@Validation({ body: CreateUserDto })
	async createUser(@Body() userData: CreateUserDto) {
		const user = await this.userService.create(userData);
		return new ResponseBuilder().created(user);
	}

	@Get('/:id')
	@Authenticated()
	@Authorized(['user:read'])
	async getUser(@Param('id') id: string) {
		const user = await this.userService.findById(id);
		return new ResponseBuilder().ok(user);
	}
}
```

## ğŸ“š API ReferansÄ±

### ğŸ—ï¸ Ana SÄ±nÄ±flar

#### **App**

Ana uygulama sÄ±nÄ±fÄ±, Express server'Ä±nÄ± yÃ¶netir.

```typescript
import { App, IConfig } from '@mini2/core';

const app = new App(controllers);
await app.init(config); // Server'Ä± baÅŸlat
await app.afterInit(); // BaÅŸlangÄ±Ã§ sonrasÄ± iÅŸlemler
```

**Ã–zellikler:**

- Express server yÃ¶netimi
- Middleware konfigÃ¼rasyonu
- Swagger dokÃ¼mantasyon entegrasyonu
- Controller routing sistemi

#### **Container & container**

Dependency injection iÃ§in InversifyJS container'larÄ±.

```typescript
import { Container, container } from '@mini2/core';

// Yeni container oluÅŸtur
const myContainer = new Container();
myContainer.bind('UserService').to(UserService);

// HazÄ±r container kullan
container.bind('UserService').to(UserService);
```

### ğŸ“‹ ArayÃ¼zler (Interfaces)

#### **IConfig**

```typescript
interface IConfig {
	host: string; // Server host adresi
	port: number; // Server portu
	applicationName: string; // Uygulama adÄ±
}
```

#### **IApp**

```typescript
interface IApp {
	init(config: IConfig): Promise<void>;
	afterInit(): Promise<void>;
}
```

#### **IRepository<IdentifierType, ModelType>**

Generic repository pattern interface'i.

```typescript
interface IRepository<IdentifierType, ModelType> {
	findAll(): Promise<(ModelType & TimestampFields)[]>;
	findById(id: IdentifierType): Promise<(ModelType & TimestampFields) | null>;
	create(item: ModelType): Promise<ModelType & TimestampFields>;
	update(
		id: IdentifierType,
		item: Partial<ModelType>
	): Promise<ModelType & TimestampFields>;
	delete(id: IdentifierType): Promise<void>;
	findPaginated(
		query: Partial<ModelType>,
		page: number,
		limit: number
	): Promise<(ModelType & TimestampFields)[]>;
	mapper(model: any): ModelType & TimestampFields;
}
```

#### **IResponseBuilder<T>**

```typescript
interface IResponseBuilder<T = any> {
	status: number;
	data: T;
	headers: Record<string, string>;
	isFile: boolean;

	ok(data: T): IResponseBuilder<T>;
	created(data: T): IResponseBuilder<T>;
	setHeader(key: string, value: string): IResponseBuilder<T>;
	setHeaders(headers: Record<string, string>): IResponseBuilder<T>;
	asFile(): IResponseBuilder<T>;
	build(res: Response): void;
}
```

### ğŸ›¡ï¸ Middleware'ler

#### **validationMiddleware**

Class-validator tabanlÄ± veri doÄŸrulama.

```typescript
import { validationMiddleware } from '@mini2/core';

// Controller iÃ§inde
@Post('/users')
@Validation({ body: CreateUserDto })
async createUser(@Body() data: CreateUserDto) {
  // DoÄŸrulanmÄ±ÅŸ data burada kullanÄ±labilir
}
```

**Desteklenen Validasyon TÃ¼rleri:**

- `body` - Request body doÄŸrulama
- `params` - URL parametreleri doÄŸrulama
- `query` - Query parametreleri doÄŸrulama

#### **authenticatedMiddleware**

Kimlik doÄŸrulama kontrolÃ¼.

```typescript
import { authenticatedMiddleware, IAuthenticatedRequest } from '@mini2/core';

// KullanÄ±m
@Get('/profile')
@Authenticated()
async getProfile(@Req() req: IAuthenticatedRequest) {
  // req.authenticated === true kontrolÃ¼ yapÄ±lÄ±r
}
```

#### **authorizedMiddleware**

Yetkilendirme kontrolÃ¼.

```typescript
import { authorizedMiddleware } from '@mini2/core';

// KullanÄ±m
@Delete('/admin/users/:id')
@Authenticated()
@Authorized(['admin', 'user:delete'])
async deleteUser(@Param('id') id: string) {
  // req.user.permissions kontrolÃ¼ yapÄ±lÄ±r
}
```

### ğŸ¯ Response Builder

HTTP yanÄ±tlarÄ±nÄ± standardize etmek iÃ§in kullanÄ±lÄ±r.

```typescript
import { ResponseBuilder } from '@mini2/core';

// Temel kullanÄ±m
return new ResponseBuilder().ok({ message: 'Success', data: users });

// BaÅŸarÄ±lÄ± kayÄ±t
return new ResponseBuilder()
	.created({ id: newUser.id })
	.setHeader('Location', `/users/${newUser.id}`);

// Dosya yanÄ±tÄ±
return new ResponseBuilder()
	.ok(fileBuffer)
	.setHeader('Content-Type', 'application/pdf')
	.asFile();

// Custom status ve header'lar
return new ResponseBuilder()
	.status(202)
	.setHeaders({
		'X-Process-Id': processId,
		'Cache-Control': 'no-cache',
	})
	.ok({ status: 'processing' });
```

### ğŸ·ï¸ Decorator'lar

#### **HTTP Method Decorator'larÄ±**

```typescript
@Get('/path')           // GET request
@Post('/path')          // POST request
@Put('/path')           // PUT request
@Delete('/path')        // DELETE request
@Patch('/path')         // PATCH request
```

#### **Parameter Decorator'larÄ±**

```typescript
@Param('id') id: string              // URL parametresi
@Body() data: CreateUserDto          // Request body
@Query('page') page: number          // Query parametresi
@Req() request: Request              // Request objesi
@Res() response: Response            // Response objesi
@Next() next: NextFunction           // Next function
```

#### **Middleware Decorator'larÄ±**

```typescript
@Authenticated()                     // Kimlik doÄŸrulama gerekli
@Authorized(['admin'])              // Yetkilendirme kontrolÃ¼
@Validation({ body: UserDto })       // Veri doÄŸrulama
@Middleware(customMiddleware)        // Custom middleware
```

### âš ï¸ Exception Handling

Ã–nceden tanÄ±mlanmÄ±ÅŸ HTTP exception'larÄ±.

```typescript
import {
	HttpException,
	BadRequestException,
	UnauthorizedException,
	ForbiddenException,
	NotFoundException,
	// ... diÄŸer exception'lar
} from '@mini2/core';

// Temel kullanÄ±m
throw new BadRequestException({
	message: 'Invalid input data',
	validationErrors: [{ field: 'email', errors: ['Invalid email format'] }],
});

// Custom exception
throw new HttpException(
	{
		message: 'Custom error message',
		errorId: 1001,
	},
	422
);
```

**Mevcut Exception'lar:**

- `BadRequestException` (400)
- `UnauthorizedException` (401)
- `PaymentRequiredException` (402)
- `ForbiddenException` (403)
- `NotFoundException` (404)
- `MethodNotAllowedException` (405)
- `ConflictException` (409)
- `UnprocessableEntityException` (422)
- `TooManyRequestsException` (429)
- `InternalServerErrorException` (500)
- ve daha fazlasÄ±...

### ğŸ› ï¸ YardÄ±mcÄ± Fonksiyonlar

#### **arrayUnify**

Dizi elemanlarÄ±nÄ± birleÅŸtirir ve tekrarlarÄ± kaldÄ±rÄ±r.

```typescript
import { arrayUnify } from '@mini2/core';

const result = arrayUnify([1, 2, 2, 3, 1]); // [1, 2, 3]
```

#### **Math Utilities**

```typescript
import { sum } from '@mini2/core';

const result = sum(5, 3); // 8
```

### ğŸ“– Swagger Entegrasyonu

Otomatik API dokÃ¼mantasyonu oluÅŸturulur.

```typescript
// Swagger dokÃ¼mantasyonu ÅŸu adreslerde mevcut:
// http://localhost:3000/api-docs      - Swagger UI
// http://localhost:3000/api-docs.json - OpenAPI JSON
```

**Swagger KonfigÃ¼rasyonu:**

```typescript
const swaggerOptions = {
	title: config.applicationName,
	description: `API documentation for ${config.applicationName}`,
	version: '1.0.0',
	servers: [{ url: `http://${config.host}:${config.port}` }],
	docsPath: '/api-docs',
	jsonPath: '/api-docs.json',
};
```

### ğŸ“ TypeScript DesteÄŸi

Tam TypeScript desteÄŸi ile type-safe API geliÅŸtirme:

```typescript
// DTO sÄ±nÄ±flarÄ±
export class CreateUserDto {
  @IsEmail()
  email: string;

  @IsString()
  @MinLength(3)
  name: string;

  @IsOptional()
  @IsNumber()
  age?: number;
}

// Controller'da kullanÄ±m
@Post('/users')
@Validation({ body: CreateUserDto })
async createUser(@Body() userData: CreateUserDto): Promise<ResponseBuilder<User>> {
  const user = await this.userService.create(userData);
  return new ResponseBuilder<User>().created(user);
}
```

## ğŸ”§ GeliÅŸmiÅŸ KullanÄ±m

### Custom Middleware Ekleme

```typescript
import { middleware } from '@mini2/core';

const loggerMiddleware = (req: Request, res: Response, next: NextFunction) => {
  console.log(`${req.method} ${req.path}`);
  next();
};

@Get('/users')
@Middleware(loggerMiddleware)
async getUsers() {
  // Logger middleware otomatik Ã§alÄ±ÅŸÄ±r
}
```

### Dependency Injection

```typescript
import { Container, injectable, inject } from '@mini2/core';

@injectable()
export class UserService {
	constructor(@inject('UserRepository') private userRepo: IUserRepository) {}
}

// Container konfigÃ¼rasyonu
container.bind('UserRepository').to(UserRepository);
container.bind('UserService').to(UserService);
```

## ğŸ“‹ Tam Export Listesi

```typescript
// Ana sÄ±nÄ±flar
export { App } from '@mini2/core';
export { Container, container } from '@mini2/core';

// Interfaces
export { IApp, IConfig, IRepository, IResponseBuilder } from '@mini2/core';

// Middleware'ler
export {
	validationMiddleware,
	authenticatedMiddleware,
	authorizedMiddleware,
} from '@mini2/core';

// Utilities
export { arrayUnify, sum, ResponseBuilder } from '@mini2/core';

// Exception'lar
export {
	HttpException,
	BadRequestException,
	UnauthorizedException,
	// ... tÃ¼m exception'lar
} from '@mini2/core';

// Types ve decorators
export { MINI_TYPES } from '@mini2/core';
export {
	Controller,
	Get,
	Post,
	Put,
	Delete,
	Patch,
	Body,
	Param,
	Query,
	Req,
	Res,
	Next,
	Authenticated,
	Authorized,
	Validation,
	Middleware,
} from '@mini2/core';

// Swagger
export { SwaggerIntegration, SwaggerOptions } from '@mini2/core';
```

## ğŸ“„ Lisans

ISC

## ğŸ‘¨â€ğŸ’» Yazar

**Mustafa Ã‡olakoÄŸlu**  
Email: mustafacolakoglu94@gmail.com  
GitHub: https://github.com/mustafa-colakoglu

---

**Not:** Bu framework aktif olarak geliÅŸtirilmektedir. Ã–neriler ve katkÄ±lar iÃ§in GitHub repository'sini ziyaret edin.
